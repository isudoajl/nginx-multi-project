# Security settings - HTTP context only
# Rate limiting zones - limits clients to 10 requests per second
limit_req_zone $binary_remote_addr zone=projectlimit:10m rate=10r/s;
limit_conn_zone $binary_remote_addr zone=projectconn:10m;

# Block common malicious bot user agents
map $http_user_agent $bad_bot {
    default 0;
    ~*(nmap|nikto|sqlmap|arachni|dirbuster|gobuster|w3af|nessus|masscan|ZmEu|zgrab) 1;
    ~*(python-requests|python-urllib|python-httpx|go-http-client|curl|wget) 1;
    "" 1; # Empty user agent
}

# Block requests with unusual HTTP methods
map $request_method $method_allowed {
    default 1;
    ~*(TRACE|TRACK|DEBUG) 0;
}

# Note: Rate limiting application, if directives, and location blocks must be in server context
